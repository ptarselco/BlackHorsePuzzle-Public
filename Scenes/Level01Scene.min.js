class Level01Scene extends Phaser.Scene{constructor(){super("Level01Scene"),this.currentFavMusic=null,this.favMusicTimeLeft=0,this.favMusicTimer=null,this.hasClaimedHat=!1,this.hasWonOnce=!1,this.airBtn=null,this.grassBtn=null,this.carrotBtn=null,this.carrotLeaf=null,this.appleBtn=null,this.favoritItemBought=null,this.favoritItemBtnRef=null}preload(){for(let t=1;t<=10;t++){let e=t.toString().padStart(2,"0");this.load.image(`hex${t}`,`./Puzzle-Assets/Level01/Lv.01 Hex-${e}.png`)}this.load.image("boardLevel01","./Puzzle-Assets/Level01/Board Game Puzzle Level-01.png"),this.load.image("textGlow02","./Puzzle-Assets/UI/Sp. Text Level 02 Glow.png"),this.load.image("help_en","./Puzzle-Assets/Level01/Lv.01 Help - English.png"),this.load.image("help_id","./Puzzle-Assets/Level01/Lv.01 Help - Indonesia.png"),this.load.image("hexSlot01","./Puzzle-Assets/UI/GM. Slot Hexa01.png"),this.load.image("hexSlot02","./Puzzle-Assets/UI/GM. Slot Hexa02.png"),this.load.image("hexSlot03","./Puzzle-Assets/UI/GM. Slot Hexa03.png"),this.load.image("hexSlot04","./Puzzle-Assets/UI/GM. Slot Hexa04.png"),this.load.image("hexSlot05","./Puzzle-Assets/UI/GM. Slot Hexa05.png"),this.load.image("hexSlot06","./Puzzle-Assets/UI/GM. Slot Hexa06.png"),this.load.image("hexSlot07","./Puzzle-Assets/UI/GM. Slot Hexa07.png"),this.load.image("hexSlot08","./Puzzle-Assets/UI/GM. Slot Hexa08.png"),this.load.image("hexSlot09","./Puzzle-Assets/UI/GM. Slot Hexa09.png"),this.load.image("hexSlot010","./Puzzle-Assets/UI/GM. Slot Hexa10.png"),this.load.image("playSheriff","./Puzzle-Assets/UI/GM. Play.png"),this.load.image("playSheriffL","./Puzzle-Assets/UI/GM. Play Light.png"),this.load.image("horse","./Puzzle-Assets/UI/GM. Black Horse Run Behind.png"),this.load.image("blankBhL1","./Puzzle-Assets/UI/Blank Black Horse Level01.png"),this.load.image("bhAngguk1","./Puzzle-Assets/UI/GM. BH Head Angguk1.png"),this.load.image("bhAngguk2","./Puzzle-Assets/UI/GM. BH Head Angguk2.png"),this.load.image("bhAngguk3","./Puzzle-Assets/UI/GM. BH Head Angguk3.png"),this.load.image("bhGeleng1","./Puzzle-Assets/UI/GM. BH Head Geleng1.png"),this.load.image("bhGeleng2","./Puzzle-Assets/UI/GM. BH Head Geleng2.png"),this.load.image("bhGeleng3","./Puzzle-Assets/UI/GM. BH Head Geleng3.png"),this.load.image("download","./Puzzle-Assets/UI/GM. Cowboy-brown-hat-win.png"),this.load.image("soundOn","./Puzzle-Assets/UI/GM. Sound On.png"),this.load.image("soundOnL","./Puzzle-Assets/UI/GM. Sound On Light.png"),this.load.image("soundOff","./Puzzle-Assets/UI/GM. Sound Off.png"),this.load.image("soundOffL","./Puzzle-Assets/UI/GM. Sound Off Light.png"),this.load.image("lv01Puzzle10","./Puzzle-Assets/UI/GM. L01-10 Puzzle.png"),this.load.image("lv01Puzzle20","./Puzzle-Assets/UI/GM. L01-20 Puzzle.png"),this.load.image("helpBtn","./Puzzle-Assets/UI/GM. Help.png"),this.load.image("back","./Puzzle-Assets/UI/GM. Back.png"),this.load.image("next","./Puzzle-Assets/UI/GM. Next.png"),this.load.image("claimHat","./Puzzle-Assets/UI/GM. Claim Hat.png"),this.load.image("claimHatC","./Puzzle-Assets/UI/GM. Claim Hat Coklat.png"),this.load.image("paypalQR","./Puzzle-Assets/UI/BLACK HORSE-qrcode.png"),this.load.image("gameOver","./Puzzle-Assets/UI/GM. Game Over.png"),this.load.image("water1","./Puzzle-Assets/UI/FW. Water1.png"),this.load.image("water2","./Puzzle-Assets/UI/FW. Water2.png"),this.load.image("water3","./Puzzle-Assets/UI/FW. Water3.png"),this.load.image("grass","./Puzzle-Assets/UI/FG. Grass04.png"),this.load.image("carrot","./Puzzle-Assets/UI/FC. Carrot.png"),this.load.image("apple1","./Puzzle-Assets/UI/FA. Appel1.png"),this.load.image("apple2","./Puzzle-Assets/UI/FA. Appel2.png"),this.load.image("apple3","./Puzzle-Assets/UI/FA. Appel3.png"),this.load.image("apple4","./Puzzle-Assets/UI/FA. Appel4.png"),this.load.image("musicNoteB","./Puzzle-Assets/UI/FN. Not Blue Cyan.png"),this.load.image("musicNoteG","./Puzzle-Assets/UI/FN. Not Green.png"),this.load.image("musicNoteR","./Puzzle-Assets/UI/FN. Not Red.png"),this.load.audio("introMusic","./Puzzle-Assets/Sfx/scenes/level01-1-herdhorses-guitar-intro-ident.mp3"),this.load.audio("mainMusic","./Puzzle-Assets/Sfx/scenes/level01-2 music-favorite-sunset-dreams.mp3"),this.load.audio("winMusic","./Puzzle-Assets/Sfx/scenes/win-in-the-video-game.mp3"),this.load.audio("horseNeigh","./Puzzle-Assets/Sfx/sound/horse-neigh.mp3"),this.load.audio("horseSnort","./Puzzle-Assets/Sfx/sound/horse-snort.mp3"),this.load.audio("horseHoof","./Puzzle-Assets/Sfx/sound/hoof-run.mp3"),this.load.audio("horsehoofstep","./Puzzle-Assets/Sfx/sound/hoof-step.mp3"),this.load.audio("horseGallop","./Puzzle-Assets/Sfx/sound/blackhorse-gallop.mp3"),this.load.audio("herdGallop","./Puzzle-Assets/Sfx/sound/herd-gallop.mp3");for(let s=1;s<=10;s++)this.load.audio("musicfav01","./Puzzle-Assets/Sfx/music favorites/music-favorite-beautiful-sunset.mp3"),this.load.audio("musicfav02","./Puzzle-Assets/Sfx/music favorites/music-favorite-drippy-cowboy-country-rnbsuno.mp3"),this.load.audio("musicfav03","./Puzzle-Assets/Sfx/music favorites/music-favorite-easy-country-music-intro-outro.mp3"),this.load.audio("musicfav04","./Puzzle-Assets/Sfx/music favorites/music-favorite-golden-sunset-piano.mp3"),this.load.audio("musicfav05","./Puzzle-Assets/Sfx/music favorites/music-favorite-horsepower.mp3"),this.load.audio("musicfav06","./Puzzle-Assets/Sfx/music favorites/music-favorite-musique-west-cowboy.mp3"),this.load.audio("musicfav07","./Puzzle-Assets/Sfx/music favorites/music-favorite-old-west.mp3"),this.load.audio("musicfav08","./Puzzle-Assets/Sfx/music favorites/music-favorite-Relaxing_Green_Nature.mp3"),this.load.audio("musicfav09","./Puzzle-Assets/Sfx/music favorites/music-favorite-starlit-serenade.mp3"),this.load.audio("musicfav10","./Puzzle-Assets/Sfx/music favorites/music-favorite-sunset-dreams.mp3")}create(){this.add.image(960,640,"boardLevel01").setDepth(0),this.sound.stopAll(),this.add.rectangle(0,0,1960,1280,1580068).setOrigin(0).setAlpha(.01),this.timerText=this.add.text(563,40,"00:00",{font:"50px Segoe UI",fill:"#fff"}),this.add.image(9640,400,"gameOver").setOrigin(.5).setDepth(200).setScale(1),this.countdownText=this.add.text(510,110,"",{font:"bold 28px Segoe UI",fill:"#00eaff"}).setDepth(9999).setVisible(!1),this.score=parseInt(localStorage.getItem("playerScore"))||this.registry.get("score")||0,this.registry.set("score",this.score),this.bhHead=this.add.image(248,250,"bhGeleng2").setScale(.5).setDepth(10),this.bhAngguk2=this.add.image(248,250,"bhAngguk2").setScale(.5).setDepth(10),this.blankBhL1=this.add.image(248,250,"blankBhL1").setScale(.7).setDepth(9),this.scoreText=this.add.text(1716,40,"00000",{font:"50px Segoe UI",fill:"#fff"}).setDepth(9999),this.scoreText.setText(this.score.toString().padStart(5,"0")),this.round=1,this.roundTimeLimits=[18,10,8],this.add.image(1410,1100,"lv01Puzzle20").setScale(.3).setInteractive().setDepth(999);let t=this.add.image(1270,1100,"lv01Puzzle10").setScale(.3).setInteractive().setDepth(999);t.on("pointerdown",()=>{!this.isGameOver&&(this.tweens.add({targets:t,scale:.35,duration:200,yoyo:!0,repeat:2,ease:"Sine.easeInOut"}),this.round=1,this.score=0,this.scoreText.setText(this.score.toString().padStart(5,"0")),this.playBtn&&(this.playBtn.setTexture("playSheriffL"),this.playBtn.setInteractive(),this.playBtn.setAlpha(1),this.playBtn.setVisible(!0)))});let e=this.add.image(1410,1100,"lv01Puzzle20").setScale(.3).setInteractive().setDepth(999);e.on("pointerdown",()=>{this.comingSoonText&&this.comingSoonText.destroy(),this.comingSoonText=this.add.text(1160,600,"20 Puzzle - Coming Soon!",{font:"bold 48px Segoe UI",fill:"#00eaff",padding:{left:30,right:30,top:10,bottom:10}}).setOrigin(.5).setDepth(2e3),this.time.delayedCall(2e3,()=>{this.comingSoonText&&this.comingSoonText.destroy()})});let s=this.add.image(240,1010,"helpBtn").setScale(.9).setInteractive({useHandCursor:!0});s.on("pointerdown",()=>{this.helpPanelGroup&&(this.helpPanelGroup.clear(!0,!0),this.helpPanelGroup=null),this.helpPanelGroup=this.add.group();let t=this.add.image(960,640,"help_en").setDepth(3001);this.helpPanelGroup.add(t);let e=this.add.text(1150,220,"EN",{font:"bold 28px Segoe UI",fill:"#00eaff"}).setInteractive({useHandCursor:!0}).setDepth(3002);this.helpPanelGroup.add(e);let s=this.add.text(1220,220,"ID",{font:"bold 28px Segoe UI",fill:"#00eaff"}).setInteractive({useHandCursor:!0}).setDepth(3002);this.helpPanelGroup.add(s),e.on("pointerdown",()=>{t.setTexture("help_en")}),s.on("pointerdown",()=>{t.setTexture("help_id")});let i=this.add.text(1280,220,"X",{font:"bold 28px Segoe UI",fill:"#fff",backgroundColor:"#e00"}).setInteractive({useHandCursor:!0}).setDepth(3002);this.helpPanelGroup.add(i),i.on("pointerdown",()=>{this.helpPanelGroup.clear(!0,!0),this.helpPanelGroup=null})});let i=this.add.image(100,1010,"back").setScale(.9).setInteractive({useHandCursor:!0});i.on("pointerdown",()=>{this.scene.start("SplashScene")});let a=this.add.image(380,1010,"next").setScale(.9).setInteractive({useHandCursor:!0});a.on("pointerdown",()=>{this.scene.start("Level02Scene")}),this.soundOnBtn=this.add.image(1550,1102,"soundOn").setScale(.7).setInteractive().setDepth(999),this.soundOnLightBtn=this.add.image(1550,1102,"soundOnL").setScale(.7).setInteractive().setDepth(1e3).setVisible(!1),this.soundOffBtn=this.add.image(1670,1115,"soundOff").setScale(.7).setInteractive().setDepth(999),this.soundOffLightBtn=this.add.image(1671,1106,"soundOffL").setScale(.7).setInteractive().setDepth(1e3).setVisible(!1),this.hasClaimedHat=this.registry.get("hasClaimedHat")||!1,this.claimHatBottomBtn=this.add.image(1820,1113,this.hasClaimedHat?"claimHatC":"claimHat").setScale(this.hasClaimedHat?.3:.7).setInteractive({useHandCursor:!0}).setDepth(1e3),this.claimHatBottomBtn.on("pointerdown",()=>{if((this.score||0)>=100){this.hasClaimedHat=!0,this.registry.set("hasClaimedHat",!0),this.claimHatBottomBtn.setTexture("claimHatC").setScale(.3);let t=document.createElement("a");t.href="./Puzzle-Assets/UI/GM. Cowboy-brown-hat-win.png",t.download="GM. Cowboy-brown-hat-win.png",document.body.appendChild(t),t.click(),document.body.removeChild(t),this.claimHatMsg&&this.claimHatMsg.destroy(),this.claimHatMsg=this.add.text(1820,1060,"Hat claimed!",{font:"bold 20px Segoe UI",fill:"#00eaff",backgroundColor:"#fff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setDepth(2100),this.time.delayedCall(1500,()=>{this.claimHatMsg&&this.claimHatMsg.destroy()})}else 100>(this.score||0)&&(this.claimHatMsg&&this.claimHatMsg.destroy(),this.claimHatMsg=this.add.text(1800,1060,"Score must be at least 100!",{font:"bold 16px Segoe UI",fill:"#fff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setDepth(2100),this.time.delayedCall(1500,()=>{this.claimHatMsg&&this.claimHatMsg.destroy()}))}),this.isGameOver=!1,this.add.image(999,1100,"apple1").setScale(.7),this.add.image(999,1100,"apple2").setScale(.7),this.add.image(999,1100,"apple3").setScale(.7),this.add.image(999,1100,"apple4").setScale(.7),this.airBtn=this.add.image(579,1102,"water3").setScale(.35).setInteractive({useHandCursor:!0}),this.appleBtn=this.add.image(999,1100,"apple1").setScale(.7).setInteractive({useHandCursor:!0});let o=["water1","water2","water3"],n=0,h=null;this.airBtn.on("pointerover",()=>{h=this.time.addEvent({delay:200,loop:!0,callback:()=>{n=(n+1)%o.length,this.airBtn.setTexture(o[n])}})}),this.airBtn.on("pointerout",()=>{h&&(h.remove(),h=null),this.airBtn.setTexture("water3")}),this.airBtn.on("pointerdown",()=>{this.gameOverImg&&(this.gameOverImg.destroy(),this.gameOverImg=null),this.showFavoritPayPanel("Water",30,1,this.airBtn)}),this.grassContainer=this.add.container(713,1200);let r=this.add.image(0,0,"grass").setScale(.17).setOrigin(.5,1).setInteractive({useHandCursor:!0});this.grassContainer.add(r),this.grassContainer.setSize(r.displayWidth,r.displayHeight);let l=null;r.on("pointerover",()=>{l=this.tweens.add({targets:this.grassContainer,angle:{from:-7,to:7},duration:400,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}),r.on("pointerout",()=>{l&&(l.stop(),l=null),this.grassContainer.angle=0}),r.on("pointerdown",()=>{this.gameOverImg&&(this.gameOverImg.destroy(),this.gameOverImg=null),this.showFavoritPayPanel("Grass",30,1,this.grassContainer)}),this.carrotBtn=this.add.image(863,1085,"carrot").setScale(.3).setInteractive({useHandCursor:!0});let $=null;this.carrotBtn.on("pointerover",()=>{$=this.tweens.add({targets:this.carrotBtn,angle:{from:-20,to:20},duration:400,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}),this.carrotBtn.on("pointerout",()=>{$&&($.stop(),$=null),this.carrotBtn.angle=0}),this.carrotBtn.on("pointerdown",()=>{this.gameOverImg&&(this.gameOverImg.destroy(),this.gameOverImg=null),this.showFavoritPayPanel("Carrot",60,2,this.carrotBtn)});let d=["apple1","apple2","apple3","apple4"],u=0,p=null;this.appleBtn.on("pointerover",()=>{p=this.time.addEvent({delay:180,loop:!0,callback:()=>{u=(u+1)%d.length,this.appleBtn.setTexture(d[u])}})}),this.appleBtn.on("pointerout",()=>{p&&(p.remove(),p=null),this.appleBtn.setTexture("apple1")}),this.appleBtn.on("pointerdown",()=>{this.gameOverImg&&(this.gameOverImg.destroy(),this.gameOverImg=null),this.showFavoritPayPanel("Appel",60,2,this.appleBtn)}),this.musicNotes=[this.add.image(1100,1100,"musicNoteB").setScale(.4).setDepth(9999).setInteractive({useHandCursor:!0}),this.add.image(1130,1100,"musicNoteG").setScale(.4).setDepth(9999).setInteractive({useHandCursor:!0}),this.add.image(1160,1100,"musicNoteR").setScale(.4).setDepth(9999).setInteractive({useHandCursor:!0}),],this.musicNotes.forEach(t=>{t.on("pointerover",()=>{t.tween=this.tweens.add({targets:t,y:t.y-20,duration:180,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),t.tweenScale=this.tweens.add({targets:t,scale:.5,duration:180,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}),t.on("pointerout",()=>{t.tween&&(t.tween.stop(),t.tween=null),t.y=1100,t.setScale(.4)}),t.on("pointerdown",()=>{this.gameOverImg&&(this.gameOverImg.destroy(),this.gameOverImg=null),this.showMusicPanel()})}),this.createSheriffPlayButton(),this.createHelpPanel(),this.puzzlePositions=[{x:590,y:358},{x:799,y:355},{x:1006,y:356},{x:1110,y:534},{x:903,y:534},{x:694,y:535},{x:590,y:716},{x:799,y:712},{x:905,y:893},{x:1005,y:712}],this.puzzlePieces=[],this.puzzlePieceNumbers=[];for(let c=0;c<10;c++){let m=c+1,g=this.add.image(118,465,`hex${c+1}`).setOrigin(.5).setScale(.29).setAlpha(.01).setDepth(2).setVisible(!0).setInteractive({useHandCursor:!0}).setData("number",m);this.puzzlePieces.push(g);let f=this.add.text(g.x,g.y,m,{font:"bold 32px Arial",fill:"#fff",stroke:"#000",strokeThickness:4}).setOrigin(.5).setDepth(3).setAlpha(.01);this.puzzlePieceNumbers.push(f)}this.rightBoardVisuals=[],this.rightBoardNumbers=[],this.rightBoardPositions=[{x:1400,y:417},{x:1503,y:358},{x:1607,y:416.7},{x:1607,y:537},{x:1503,y:474},{x:1400,y:539},{x:1400,y:655},{x:1503,y:595},{x:1503,y:715},{x:1610,y:660}];for(let _=0;_<10;_++){let y=this.rightBoardPositions[_],v=this.add.image(y.x,y.y,`hexSlot0${_+1}`).setOrigin(.5).setScale(1).setAlpha(.2).setDepth(1);this.rightBoardVisuals.push(v);let x=this.add.text(y.x,y.y,_+1,{font:"bold 32px Arial",fill:"#fff",stroke:"#000",strokeThickness:4}).setOrigin(.5).setDepth(5).setAlpha(.01);this.rightBoardNumbers.push(x)}this.introMusic=this.sound.add("introMusic"),this.mainMusic=this.sound.add("mainMusic",{loop:!0}),this.winMusic=this.sound.add("winMusic"),this.horseNeigh=this.sound.add("horseNeigh"),this.horseSnort=this.sound.add("horseSnort"),this.horseHoof=this.sound.add("horseHoof"),this.horseGallop=this.sound.add("horseGallop"),this.herdGallop=this.sound.add("herdGallop"),this.introMusic.setVolume(.5),this.mainMusic.setVolume(.5),this.winMusic.setVolume(.5),this.horseNeigh.setVolume(.5),this.horseSnort.setVolume(.5),this.horseHoof.setVolume(.5),this.horseGallop.setVolume(.5),this.herdGallop.setVolume(.5),this.introMusic.play(),this.introMusic.once("complete",()=>{this.mainMusic.play()}),this.soundOffBtn.on("pointerdown",()=>{this.currentFavMusic&&this.isFavMusicActive&&this.currentFavMusic.isPlaying&&(this.currentFavMusic.pause(),this.soundOffLightBtn.setVisible(!0),this.soundOnLightBtn.setVisible(!1))}),this.soundOnBtn.on("pointerdown",()=>{this.currentFavMusic&&this.isFavMusicActive&&this.currentFavMusic.isPaused&&(this.currentFavMusic.resume(),this.soundOnLightBtn.setVisible(!0),this.soundOffLightBtn.setVisible(!1))}),this.soundOnLightBtn.on("pointerdown",()=>{this.soundOnLightBtn.setVisible(!1),this.soundOnBtn.setVisible(!0),this.soundOffBtn.setVisible(!0),this.soundOffLightBtn.setVisible(!1)}),this.soundOffLightBtn.on("pointerdown",()=>{this.soundOffLightBtn.setVisible(!1),this.soundOnBtn.setVisible(!0),this.soundOffBtn.setVisible(!0),this.soundOnLightBtn.setVisible(!1)})}createSheriffPlayButton(){let t=this.add.image(250,830,"playSheriff").setScale(.3).setInteractive({useHandCursor:!0}).setDepth(999);this.playBtn=t,t.on("pointerdown",()=>{t.setTexture("playSheriffL"),t.setScale(.4),this.claimHatBtn&&(this.claimHatBtn.destroy(),this.claimHatBtn=null),this.downloadHat&&(this.downloadHat.destroy(),this.downloadHat=null),this.winMusic&&this.winMusic.isPlaying&&this.winMusic.stop(),this.currentFavMusic&&this.isFavMusicActive&&this.currentFavMusic.isPaused&&(this.currentFavMusic.resume(),this.soundOffBtn.clearTint()),this.isFavMusicActive&&this.favoritTimeToAdd||(this.timeElapsed=0,this.timerText.setText("00:00")),this.roundTimer&&this.roundTimer.remove(!1);let e=this.roundTimeLimits[this.round-1]||18;this.roundTimer=this.time.addEvent({delay:1e3,callback:()=>{this.timeElapsed++;let t=Math.floor(this.timeElapsed/60).toString().padStart(2,"0"),s=(this.timeElapsed%60).toString().padStart(2,"0");this.timerText.setText(`${t}:${s}`),this.timeElapsed>=e&&(this.roundTimer.remove(!1),this.onTimeUp()),this.mainMusic&&!this.mainMusic.isPlaying&&this.mainMusic.play({loop:!0})},callbackScope:this,loop:!0}),this.tweens.add({targets:t,y:t.y+10,duration:80,yoyo:!0,ease:"Sine.easeInOut"}),this.tweens.killAll(),this.order=Phaser.Utils.Array.NumberArray(0,9),Phaser.Utils.Array.Shuffle(this.order);for(let s=0;s<10;s++){let i=this.puzzlePieces[this.order[s]];i.x=118,i.y=465,i.setAlpha(.01),i.setVisible(!0),i.setInteractive(),this.puzzlePieceNumbers[s].x=118,this.puzzlePieceNumbers[s].y=465,this.puzzlePieceNumbers[s].setAlpha(.01)}this.rightBoardSlots=Array(10).fill(null);for(let a=0;a<10;a++)this.puzzlePieces[this.order[a]].setData("gridIdx",a);function o(t,e,s,i,a){t.angle=0,this.tweens.add({targets:t,x:850+300*Math.cos(e/9*Math.PI*2),y:600+300*Math.sin(e/9*Math.PI*2),angle:360,duration:700,ease:"Sine.easeInOut",onComplete:()=>{s<i?this.tweens.add({targets:t,x:850,y:600,angle:0,duration:300,ease:"Sine.easeInOut",onComplete:()=>{o.call(this,t,e,s+1,i,a)}}):a()}})}this.helpPanel&&this.helpPanel.setAlpha(0),this.helpText&&this.helpText.setAlpha(0);for(let n=0;n<10;n++){let h=this.puzzlePieces[this.order[n]];h.setVisible(!0),h.setAlpha(1),h.x=450,h.y=170,this.tweens.add({targets:h,x:850,y:600,duration:500,ease:"Sine.easeInOut",onComplete:()=>{this.tweens.add({targets:h,x:850+300*Math.cos(n/9*Math.PI*2),y:600+300*Math.sin(n/9*Math.PI*2),angle:360,duration:500,ease:"Sine.easeInOut",onComplete:()=>{o.call(this,h,n,0,1,()=>{this.tweens.add({targets:h,x:this.puzzlePositions[n].x,y:this.puzzlePositions[n].y,angle:0,duration:500,ease:"Sine.easeInOut",onComplete:()=>{h.setData("gridIdx",n),9===n&&this.favoritTimeToAdd&&(this.addFavoritTimeToMainTimer(this.favoritTimeToAdd,this.favoritLabelToAdd),this.favoritTimeToAdd=null,this.favoritLabelToAdd=null),h.removeAllListeners(),h.setInteractive(),h.on("pointerdown",()=>{let t=h.getData("number"),e=t-1,s=h.getData("gridIdx");if(e!==this.rightBoardSlots.findIndex(t=>null===t)){this.tweens.add({targets:h,x:this.rightBoardPositions[e].x,y:this.rightBoardPositions[e].y,duration:200,ease:"Sine.easeInOut",onComplete:()=>{this.tweens.add({targets:h,x:this.puzzlePositions[s].x,y:this.puzzlePositions[s].y,duration:250,ease:"Sine.easeInOut"})}});return}null===this.rightBoardSlots[e]&&this.tweens.add({targets:h,x:this.rightBoardPositions[e].x,y:this.rightBoardPositions[e].y,duration:200,ease:"Sine.easeInOut",onUpdate:()=>{this.puzzlePieceNumbers[t-1].x=h.x,this.puzzlePieceNumbers[t-1].y=h.y},onComplete:()=>{this.puzzlePieceNumbers[t-1].x=this.rightBoardPositions[e].x,this.puzzlePieceNumbers[t-1].y=this.rightBoardPositions[e].y,this.rightBoardSlots[e]=t,h.disableInteractive(),this.rightBoardSlots.every(t=>null!==t)&&this.checkPuzzle()}})})}})})}})}})}})}createHelpPanel(){this.helpPanel=this.add.rectangle(1050,320,340,340,1580068,.82).setStrokeStyle(3,60159).setAlpha(0).setDepth(100),this.helpText=this.add.text(900,180,{font:"20px Segoe UI",fill:"#fff",wordWrap:{width:320}}).setAlpha(0).setDepth(101)}checkPuzzle(){console.log("rightBoardSlots:",this.rightBoardSlots);let t=!0;for(let e=0;e<10;e++)if(this.rightBoardSlots[e]!==e+1){t=!1;break}t?(this.roundTimer&&(this.roundTimer.remove(!1),this.roundTimer=null),this.score=(this.score||0)+100,this.scoreText.setText(this.score.toString().padStart(5,"0")),this.registry.set("score",this.score),localStorage.setItem("playerScore",this.score),this.sound.play("horseNeigh"),this.showClaimHat(()=>{}),this.showClaimHat(()=>{this.playBtn&&(this.playBtn.setInteractive(),this.playBtn.setAlpha(1),this.playBtn.setVisible(!0))})):this.onTimeUp()}showClaimHat(t){this.claimHatBtn&&(this.claimHatBtn.destroy(),this.claimHatBtn=null),this.downloadHat&&(this.downloadHat.destroy(),this.downloadHat=null),this.winMusic&&this.winMusic.play(),this.horseNeigh&&this.horseNeigh.play(),this.mainMusic&&this.mainMusic.isPlaying&&this.mainMusic.pause(),this.currentFavMusic&&this.currentFavMusic.isPlaying&&this.currentFavMusic.pause(),this.winMusic.once("complete",()=>{this.currentFavMusic&&this.isFavMusicActive?this.currentFavMusic.resume():this.mainMusic&&this.mainMusic.resume()}),this.hasWonOnce?t&&t():(this.hasWonOnce=!0,this.claimHatBtn=this.add.image(1100,650,"claimHat").setScale(.7).setInteractive(),this.claimHatBtn.on("pointerdown",()=>{this.claimHatBtn&&(this.claimHatBtn.destroy(),this.claimHatBtn=null),this.claimHatMsg&&this.claimHatMsg.destroy(),this.claimHatMsg=this.add.text(1100,600,"Claim your hat below!",{font:"bold 24px Segoe UI",fill:"#00eaff",backgroundColor:"#fff",padding:{left:20,right:20,top:10,bottom:10}}).setOrigin(.5).setDepth(2100),this.time.delayedCall(1200,()=>{this.claimHatMsg&&this.claimHatMsg.destroy()}),t&&t()}))}onTimeUp(){if(this.sound.play("horseSnort"),this.score=Math.max(0,(this.score||0)-100),this.scoreText.setText(this.score.toString().padStart(5,"0")),this.registry.set("score",this.score),localStorage.setItem("playerScore",this.score),this.currentFavMusic&&this.currentFavMusic.isPlaying&&(this.currentFavMusic.stop(),this.isFavMusicActive=!1,this.isFavoritActive=!1),this.playBtn&&(this.playBtn.setTexture("playSheriff"),this.playBtn.setScale(.3)),this.round=(this.round||1)+1,this.showRoundMessage(""),this.showHorseShakeHead(),2===this.round)this.showRoundMessage("");else if(3===this.round)this.isGameOver=!0,this.showRoundMessage("");else if(this.round>3){for(let t=0;t<10;t++)this.puzzlePieces[t].setVisible(!1),this.puzzlePieceNumbers[t].setVisible(!1);this.showFavoritPanel(),this.rightBoardSlots=Array(10).fill(null),this.gameOverImg&&this.gameOverImg.destroy(),this.gameOverImg=this.add.image(960,400,"gameOver").setOrigin(.5).setDepth(200).setScale(.7),this.playBtn&&(this.playBtn.disableInteractive(),this.playBtn.setAlpha(.5)),this.musicNotes&&this.musicNotes.forEach(t=>t.setInteractive({useHandCursor:!0})),this.isFavMusicActive||this.isFavoritActive||this.time.delayedCall(1500,()=>{this.showFavoritPanel()});return}this.order=Phaser.Utils.Array.NumberArray(0,9),Phaser.Utils.Array.Shuffle(this.order);for(let e=0;e<10;e++){let s=this.puzzlePieces[this.order[e]],i=this.order[e];s.x=this.puzzlePositions[i].x,s.y=this.puzzlePositions[i].y,s.setAlpha(.01),s.setVisible(!0),s.setInteractive(),s.setData("gridIdx",i),this.puzzlePieceNumbers[e].x=this.puzzlePositions[i].x,this.puzzlePieceNumbers[e].y=this.puzzlePositions[i].y,this.puzzlePieceNumbers[e].setAlpha(.01),this.puzzlePieceNumbers[e].setVisible(!0)}}showHorseShakeHead(){let t=["bhGeleng1","bhGeleng2","bhGeleng3","bhGeleng1","bhGeleng2"],e=0;this.time.addEvent({repeat:t.length-1,delay:90,callback:()=>{this.bhHead.setTexture(t[e]),e++}})}showHorseNodHead(){this.bhHead&&this.bhHead.setVisible(!1),this.bhAngguk2&&this.bhAngguk2.setVisible(!0);let t=["bhAngguk1","bhAngguk2","bhAngguk3","bhAngguk2","bhAngguk1"],e=0;this.time.addEvent({repeat:t.length-2,delay:120,callback:()=>{this.bhAngguk2.setTexture(t[e]),++e===t.length&&(this.bhHead&&this.bhHead.setVisible(!0),this.bhAngguk2&&this.bhAngguk2.setVisible(!1))}})}showRoundMessage(t){this.roundMsgText&&this.roundMsgText.destroy(),this.roundMsgText=this.add.text(960,200,t,{font:"bold 120px Orbitron, Arial, sans-serif",fill:"#00eaff",stroke:"#fff",strokeThickness:8,align:"center",shadow:{offsetX:0,offsetY:0,color:"#00eaff",blur:32,fill:!0}}).setOrigin(.5).setDepth(200).setAlpha(.95).setScale(.1),this.tweens.add({targets:this.roundMsgText,scale:1,duration:900,ease:"Back.Out"}),this.time.delayedCall(4e3,()=>{this.roundMsgText&&this.roundMsgText.destroy()})}showFavoritPanel(){this.currentAboveHorse&&(this.currentAboveHorse.destroy(),this.currentAboveHorse=null),this.currentAboveHorse=this.add.image(150,100,"water2").setScale(.8).setDepth(102).setInteractive(),this.currentAboveHorse.on("pointerdown",()=>{this.payPanel&&this.payPanel.destroy(),this.payPanel=this.add.rectangle(640,360,400,200,2304058,.96).setStrokeStyle(3,60159).setDepth(200),this.payText=this.add.text(640,320,"Buy Water for Black Horse?\nClick PAY to continue!",{font:"bold 32px Segoe UI",fill:"#fff",align:"center"}).setOrigin(.5).setDepth(201),this.showFavoritMenuBar(),this.animateMusicNotes(),payBtn.on("pointerdown",()=>{this.payPanel&&this.payPanel.destroy(),this.payText&&this.payText.destroy(),this.favoritPanelGroup&&this.favoritPanelGroup.clear(!0,!0),payBtn.destroy(),this.currentAboveHorse&&(this.currentAboveHorse.destroy(),this.currentAboveHorse=null),this.isFavoritActive=!1,this.round=1,this.horseGallop&&this.horseGallop.stop(),this.puzzlePieces.forEach(t=>t.setInteractive()),this.musicNotes&&this.musicNotes.forEach(t=>t.setInteractive({useHandCursor:!0})),this.playBtn&&(this.playBtn.setInteractive({useHandCursor:!0}),this.playBtn.setAlpha(1)),this.showHorseNodHead(),this.showMusicPanel()})})}musicTitles=["Beautiful Sunset","Drippy Cowboy Country Rnbsuno","Easy Country Music Intro Outro","Golden Sunset Piano","Horsepower","Musique West Cowboy","Old West","Relaxing Green Nature","Starlit Serenade","Sunset Dreams"];showMusicPanel(){this.isFavoritActive=!1,this.musicPanelGroup&&(this.musicPanelGroup.clear(!0,!0),this.musicPanelGroup=null),this.musicPanelGroup=this.add.group();let t=this.add.rectangle(850,600,630,550,2304058,.1).setDepth(1e3);this.musicPanelGroup.add(t);let e=this.add.text(850,390,"Choose Your Favorite Music",{font:"bold 36px Imprint MT Shadow, serif",align:"center",fill:"#fff"}).setOrigin(.5).setDepth(1001);this.musicPanelGroup.add(e);for(let s=1;s<=10;s++){let i=440+(s-1)*38,a=this.musicTitles[s-1]||`Music ${s}`,o=this.add.text(600,i,a,{fontFamily:'"Imprint MT Shadow", serif',font:"bold 24px Imprint MT Shadow, serif",fill:"#fff",backgroundColor:"rgba(0,0,0,0)",padding:{left:18,right:18,top:8,bottom:8}}).setOrigin(0,.5).setDepth(1001).setInteractive({useHandCursor:!0});this.musicPanelGroup.add(o);let n=this.add.text(1050,i,"BUY $2",{fontFamily:'"Imprint MT Shadow", serif',font:"bold 24px Imprint MT Shadow, serif",fill:"#fff",backgroundColor:"rgba(0,0,0,0)",padding:{left:10,right:10,top:8,bottom:8}}).setOrigin(0,.5).setDepth(1001).setInteractive({useHandCursor:!0});this.musicPanelGroup.add(n);let h=()=>{this.confirmPanel&&this.confirmPanel.destroy(),this.confirmText&&this.confirmText.destroy(),this.confirmYes&&this.confirmYes.destroy(),this.confirmNo&&this.confirmNo.destroy(),this.confirmPanel=this.add.rectangle(850,600,400,180,2304058,.96).setDepth(2001),this.confirmText=this.add.text(850,570,`Are you sure you want to choose "${a}" for Black Horse?`,{font:"bold 22px Segoe UI",fill:"#fff",align:"center",wordWrap:{width:380}}).setOrigin(.5).setDepth(2002),this.confirmYes=this.add.text(800,630,"YES",{font:"bold 28px Segoe UI",fill:"#00eaff",backgroundColor:"#181c24",padding:{left:30,right:30,top:10,bottom:10}}).setOrigin(.5).setDepth(2002).setInteractive(),this.confirmNo=this.add.text(900,630,"NO",{font:"bold 28px Segoe UI",fill:"#fff",backgroundColor:"#181c24",padding:{left:30,right:30,top:10,bottom:10}}).setOrigin(.5).setDepth(2002).setInteractive(),this.confirmYes.on("pointerdown",()=>{this.confirmPanel.destroy(),this.confirmText.destroy(),this.confirmYes.destroy(),this.confirmNo.destroy(),this.musicPanelGroup&&(this.musicPanelGroup.clear(!0,!0),this.musicPanelGroup=null),this.payPanel&&this.payPanel.destroy(),this.payQR&&this.payQR.destroy(),this.payText&&this.payText.destroy(),this.payPanel=this.add.rectangle(850,400,600,100,2304058,.3).setStrokeStyle(3,60159).setDepth(400),this.payText=this.add.text(850,380,"Confirm payment for this music?\nClick PAY to continue!",{font:"bold 24px Imprint MT Shadow, serif",fill:"#fff",align:"center"}).setOrigin(.5).setDepth(401),this.payQR=this.add.image(850,620,"paypalQR").setScale(1).setDepth(402);let t=this.add.text(1060,420,"PAY",{font:"bold 48px Imprint MT Shadow, serif",fill:"#00eaff",padding:{left:30,right:30,top:10,bottom:10}}).setOrigin(.5).setDepth(401).setInteractive(),e=this.add.text(660,420,"CANCEL",{font:"bold 32px Imprint MT Shadow, serif",fill:"#fff",padding:{left:18,right:18,top:8,bottom:8}}).setOrigin(.5).setDepth(2004).setInteractive();e.on("pointerdown",()=>{this.payPanel&&this.payPanel.destroy(),this.payText&&this.payText.destroy(),this.payQR&&this.payQR.destroy(),t.destroy(),e.destroy()}),t.on("pointerdown",()=>{if(window.open("https://www.paypal.com/ncp/payment/7MARDZW8BDWVG"),this.payPanel&&this.payPanel.destroy(),this.payText&&this.payText.destroy(),this.payQR&&this.payQR.destroy(),t.destroy(),e.destroy(),this.timeElapsed=0,this.timerText.setText("00:00"),this.favoritTimeToAdd=60,this.favoritLabelToAdd=a,this.playBtn&&(this.playBtn.setInteractive({useHandCursor:!0}),this.playBtn.setAlpha(1)),this.time.delayedCall(5e3,()=>{this.showHorseNodHead(),this.sound.play("horseNeigh")}),this.currentAboveHorse&&(this.currentAboveHorse.destroy(),this.currentAboveHorse=null),this.currentFavMusic&&this.currentFavMusic.isPlaying&&this.currentFavMusic.stop(),this.mainMusic&&this.mainMusic.isPlaying&&this.mainMusic.stop(),this.winMusic&&this.winMusic.isPlaying&&this.winMusic.stop(),this.favoritTimeToAdd=60,this.favoritLabelToAdd=a,this.favoritTimeToAdd=60,this.favoritLabelToAdd=a,!this.currentFavMusic||!this.currentFavMusic.isPlaying){let i=`musicfav${s.toString().padStart(2,"0")}`;this.currentFavMusic=this.sound.add(i,{loop:!0}),this.currentFavMusic.play(),this.isFavMusicActive=!0}this.musicPanelGroup&&(this.musicPanelGroup.clear(!0,!0),this.musicPanelGroup=null)})}),this.confirmNo.on("pointerdown",()=>{this.confirmPanel.destroy(),this.confirmText.destroy(),this.confirmYes.destroy(),this.confirmNo.destroy()})};o.on("pointerdown",h),n.on("pointerdown",h)}let r=this.add.text(1110,390,"X",{font:"bold 14px Arial",fill:"#fff",backgroundColor:"#e00",padding:{left:10,right:10,top:2,bottom:2}}).setOrigin(.5).setDepth(1001).setInteractive({useHandCursor:!0});this.musicPanelGroup.add(r),r.on("pointerdown",()=>{this.musicPanelGroup.clear(!0,!0),this.musicPanelGroup=null,this.confirmPanel&&this.confirmPanel.destroy(),this.confirmText&&this.confirmText.destroy(),this.confirmYes&&this.confirmYes.destroy(),this.confirmNo&&this.confirmNo.destroy(),this.payPanel&&this.payPanel.destroy(),this.payText&&this.payText.destroy(),this.payQR&&this.payQR.destroy()})}addFavoritTimeToMainTimer(t,e){this.roundTimer&&(this.roundTimer.remove(!1),this.roundTimer=null),this.timeElapsed=0,this.timerText.setText("00:00");let s=t;this.roundTimer=this.time.addEvent({delay:1e3,callback:()=>{this.timeElapsed++;let t=Math.floor(this.timeElapsed/60).toString().padStart(2,"0"),e=(this.timeElapsed%60).toString().padStart(2,"0");this.timerText.setText(`${t}:${e}`),this.timeElapsed>=s&&(this.roundTimer.remove(!1),this.onTimeUp())},callbackScope:this,loop:!0})}showFavoritPayPanel(t,e,s,i){this.payPanel&&this.payPanel.destroy(),this.payText&&this.payText.destroy(),this.payQR&&this.payQR.destroy(),this.gameOverImg&&(this.gameOverImg.destroy(),this.gameOverImg=null),this.payPanel=this.add.rectangle(850,400,600,100,2304058,.3).setStrokeStyle(3,60159).setDepth(2001),this.payText=this.add.text(850,390,`Buy ${t}?
+${e}s • $${s}
Click PAY to continue!`,{font:"bold 24px Imprint MT Shadow, serif",fill:"#fff",align:"center"}).setOrigin(.5).setDepth(2002),this.payQR=this.add.image(850,620,"paypalQR").setScale(1).setDepth(2003);let a=this.add.text(1050,410,"PAY",{font:"bold 48px Imprint MT Shadow, serif",fill:"#00eaff",padding:{left:30,right:30,top:10,bottom:10}}).setOrigin(.5).setDepth(2004).setInteractive(),o=this.add.text(650,410,"CANCEL",{font:"bold 32px Imprint MT Shadow, serif",fill:"#fff",padding:{left:18,right:18,top:8,bottom:8}}).setOrigin(.5).setDepth(2004).setInteractive();o.on("pointerdown",()=>{this.payPanel&&this.payPanel.destroy(),this.payText&&this.payText.destroy(),this.payQR&&this.payQR.destroy(),a.destroy(),o.destroy()}),a.on("pointerdown",()=>{window.open("https://www.paypal.com/ncp/payment/7MARDZW8BDWVG"),this.payPanel&&this.payPanel.destroy(),this.payText&&this.payText.destroy(),this.payQR&&this.payQR.destroy(),a.destroy(),o.destroy(),this.favoritTimeToAdd=e,this.favoritLabelToAdd=t,this.timeElapsed=0,this.timerText&&this.timerText.setText("00:00"),this.favoritTimeToAdd=e,this.favoritLabelToAdd=t,this.playBtn&&(this.playBtn.setInteractive({useHandCursor:!0}),this.playBtn.setAlpha(1)),"Music"!==t&&"music"!==t&&this.mainMusic&&(this.currentFavMusic&&this.currentFavMusic.isPlaying&&this.currentFavMusic.stop(),this.mainMusic&&!this.mainMusic.isPlaying&&this.mainMusic.play({loop:!0}))}),this.time.delayedCall(5e3,()=>{this.showHorseNodHead(),this.sound.play("horseNeigh")}),this.currentAboveHorse&&(this.currentAboveHorse.destroy(),this.currentAboveHorse=null),i&&this.tweens.add({targets:i,scale:1.2*i.scale,duration:150,yoyo:!0})}showFavoritMenuBar(){this.favoritMenuGroup&&this.favoritMenuGroup.clear(!0,!0),this.favoritMenuGroup=this.add.group();let t=["water1","water2","water3"],e=0,s=null,i=this.add.image(600,1150,t[0]).setScale(.3).setInteractive({useHandCursor:!0});this.favoritMenuGroup.add(i),i.on("pointerover",()=>{s=this.time.addEvent({delay:200,loop:!0,callback(){e=(e+1)%t.length,i.setTexture(t[e])}})}),i.on("pointerout",()=>{s&&(s.remove(),s=null),i.setTexture("water1")}),i.on("pointerdown",()=>this.showFavoritPayPanel("Air",30,1,i));let a=this.add.image(713,1109,"grass").setScale(.2).setInteractive({useHandCursor:!0});this.favoritMenuGroup.add(a);let o=null;a.on("pointerover",()=>{o=this.tweens.add({targets:a,angle:{from:-10,to:10},duration:400,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}),a.on("pointerout",()=>{o&&(o.stop(),o=null),a.angle=0}),a.on("pointerdown",()=>this.showFavoritPayPanel("Rumput",30,1,a));let n=this.add.image(840,1150,"carrot").setScale(.5).setInteractive({useHandCursor:!0}),h=this.add.image(877,1115,"carrotL").setScale(.3).setAlpha(.7);this.favoritMenuGroup.add(n),this.favoritMenuGroup.add(h);let r=null;n.on("pointerover",()=>{r=this.tweens.add({targets:h,angle:{from:-20,to:20},duration:400,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}),n.on("pointerout",()=>{r&&(r.stop(),r=null),h.angle=0}),n.on("pointerdown",()=>this.showFavoritPayPanel("Wortel",60,2,n));let l=["apple1","apple2","apple3","apple4"],$=0,d=null,u=this.add.image(999,1150,l[0]).setScale(.7).setInteractive({useHandCursor:!0});this.favoritMenuGroup.add(u),u.on("pointerover",()=>{d=this.time.addEvent({delay:180,loop:!0,callback(){$=($+1)%l.length,u.setTexture(l[$])}})}),u.on("pointerout",()=>{d&&(d.remove(),d=null),u.setTexture("apple1")}),u.on("pointerdown",()=>this.showFavoritPayPanel("Appel",60,2,u))}startPuzzleSpin(){if(this.isFavoritActive){this.horseGallop&&!this.horseGallop.isPlaying&&this.horseGallop.play({loop:!0});for(let t=0;t<this.puzzlePieces.length;t++){let e=this.puzzlePieces[this.order[t]];this.tweens.add({targets:e,angle:e.angle+Phaser.Math.Between(90,360),duration:700,ease:"Sine.easeInOut",onComplete:()=>{this.isFavoritActive?this.startPuzzleSpin():this.horseGallop&&this.horseGallop.isPlaying&&this.horseGallop.stop()}})}this.playBtn&&(this.playBtn.setInteractive(),this.playBtn.setAlpha(1))}}transformPuzzleToHorse(){this.puzzlePieces.forEach(t=>t.setVisible(!1)),this.puzzlePieceNumbers.forEach(t=>t.setVisible(!1)),this.blackHorseSprite&&this.blackHorseSprite.destroy(),this.blackHorseSprite=this.add.image(850,600,"horse").setScale(.2).setDepth(100);let t=[{x:this.puzzlePositions[0].x,y:this.puzzlePositions[0].y},{x:this.puzzlePositions[2].x,y:this.puzzlePositions[2].y},{x:this.puzzlePositions[8].x,y:this.puzzlePositions[8].y},{x:this.puzzlePositions[6].x,y:this.puzzlePositions[6].y},{x:this.puzzlePositions[0].x,y:this.puzzlePositions[0].y}],e=0;this.isFavoritActive=!0;let s=()=>{let i=(e+1)%t.length;this.tweens.add({targets:this.blackHorseSprite,x:t[i].x,y:t[i].y,duration:1e3,ease:"Sine.easeInOut",onComplete:()=>{e=i,this.isFavoritActive&&s()}})};s(),this.time.delayedCall(2e3,()=>{this.showFavoritPanel()})}}window.Level01Scene=Level01Scene;